time_elapsed_years = {
		value = year
		add = -1428
}

settlement_amount = {
	value = state_population
	divide = 5000
	
	#multiply = modifier:country_minor_settlements_per_thousand
}

subjects_population = {
	value = 0
	
	every_country = { 
		limit = {
			is_subject_of = this
		}
		#add = total_population
		every_scope_state = {
			add = {
				value = state_population
				multiply = {
					value = 1
					add = modifier:state_empire_sprawl_load_population_cost
				}
			}
		}
	}
}

country_and_subjects_states = {
	value = 0  
	
	every_scope_state = {
		add = 1
	}
	
	every_country = {
		limit = {
			is_subject_of = this
		}
		every_scope_state = {
			add = 1
		}
	}
}

#Empire Sprawl
empire_sprawl_value = {
	if = {
		limit = {
			exists = var:var_empire_sprawl
		}
	value = var:var_empire_sprawl
	}
	else = {
		value = 0
	}
}

sprawl_capacity_value = {
	if = {
		limit = {
			exists = var:var_empire_sprawl_capacity
		}
	value = var:var_empire_sprawl_capacity
	}
	else = {
		value = 0
	}
}

sprawl_load_value = {
	if = {
		limit = {
			exists = var:var_empire_sprawl_load
		}
	value = var:var_empire_sprawl_load
	}
	else = {
		value = 0
	}
}

sprawl_get_base_value = {
	value = 0
	every_scope_state = {
			add = {
				value = state_population
				multiply = {
					value = 1
					add = modifier:state_empire_sprawl_load_population_cost
					}
				}
			}

	multiply = 1
	
	divide = 1000
}

sprawl_get_vassal_value = {
	value = subjects_population
	
	divide = 1000
	
	multiply = modifier:country_empire_sprawl_load_subject_penalty
}

sprawl_get_infamy_multiplier = {
	value = infamy
	
	divide = 50
}

sprawl_get_multiplier = {
	value = country_and_subjects_states
	
	divide = 20
	
	add = 1

}

empire_sprawl_deficit = {
	value = sprawl_capacity_value
	
	subtract = sprawl_load_value
	
	
	IF = {
		limit = {
			NOT = {
				sprawl_load_value = 0
			}
		}
		divide = sprawl_load_value
	}
	
	
	multiply = -1
	
	min = 0
	max = 1
	
	}
	
empire_sprawl_surplus = {
	value = sprawl_load_value
	
	subtract = sprawl_capacity_value
	
	
	IF = {
		limit = {
			NOT = {
				sprawl_capacity_value = 0
			}
		}
		divide = sprawl_capacity_value
	}
	
	multiply = -1
	
	min = 0
	max = 1
	
	
	}
	
empire_sprawl_deficit_mod = {

value = empire_sprawl_deficit

add = 1

}

empire_sprawl_surplus_mod = {

value = empire_sprawl_surplus

add = 1

}

empire_sprawl_bonus_or_malus = {

value = no

if = {
	limit = {
		empire_sprawl_value < 0	
		}
		value = yes
	}

}



#Civilization
civilization_value = {

	
	value = var:civilization_value
	
	
	min = 0
	#max = 1
	
}
get_civilization_level = {

	
	IF = {
		limit = {
			var:civilization_value <= 0.20
		}
		value = 1
	}
	ELSE_IF = {
		limit = {
			var:civilization_value >= 0.21
			var:civilization_value <= 0.40
		}
		
		value = 2
	}
	ELSE_IF = {
		limit = {
			var:civilization_value >= 0.41
			var:civilization_value <= 0.60
		}
		
		value = 3
	}
	ELSE_IF = {
		limit = {
			var:civilization_value >= 0.61
			var:civilization_value <= 0.80
		}
		value = 4
	}
	ELSE_IF = {
		limit = {
			var:civilization_value >= 0.81
		}
		value = 5
	}
	
}



get_loyalty = {

	
	value = modifier:character_loyalty_add
	
	
	min = -100
	max = 100
	
}


is_loyal = {

	
	IF = {
		limit = { modifier:character_loyalty_add >= 0 }
		value = 0
		}
	IF = {
		limit = { modifier:character_loyalty_add < 0 }
		value = 1
		}
	
	
}